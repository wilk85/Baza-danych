import sys
from selenium import webdriver
from bs4 import BeautifulSoup
import sqlite3

html_doc = """
<tbody><tr id="g_1_OUiIi4h8" class="tr-first stage-finished" style="cursor: pointer;"><td class="cell_ad time">11.11. 18:00</td><td class="cell_aa timer"><span>Koniec</span></td><td class="cell_ab team-home" title="Zobacz szczegóły meczu!"><span class="padr">Jagiellonia Białystok</span></td><td class="cell_sa score  bold" title="Zobacz szczegóły meczu!">2&nbsp;-&nbsp;2</td><td class="cell_ac team-away" title="Zobacz szczegóły meczu!"><span class="padl">Lech Poznań</span></td><td class="cell_sb part-top">(1 - 2)</td><td class="cell_ia icons"><span class="icons"></span></td><td class="cell_ib icons"></td></tr><tr id="g_1_2LjMjO7E" class="even stage-finished" style="cursor: pointer;"><td class="cell_ad time">11.11. 15:30</td><td class="cell_aa timer"><span>Koniec</span></td><td class="cell_ab team-home  bold"><span class="padr">Korona Kielce</span></td><td class="cell_sa score  bold">1&nbsp;-&nbsp;0</td><td class="cell_ac team-away" title="Zobacz szczegóły meczu!"><span class="padl">Piast Gliwice</span></td><td class="cell_sb part-top">(1 - 0)</td><td class="cell_ia icons"><span class="icons"></span></td><td class="cell_ib icons"></td></tr><tr id="g_1_rVbUl2xR" class=" stage-finished" style="cursor: pointer;"><td class="cell_ad time">11.11. 15:30</td><td class="cell_aa timer"><span>Koniec</span></td><td class="cell_ab team-home"><span class="padr">Miedź Legnica</span></td><td class="cell_sa score  bold">0&nbsp;-&nbsp;4</td><td class="cell_ac team-away  bold" title="Zobacz szczegóły meczu!"><span class="padl">Arka Gdynia</span></td><td class="cell_sb part-top">(0 - 1)</td><td class="cell_ia icons"><span class="icons"></span></td><td class="cell_ib icons"></td></tr><tr id="g_1_v1p0qt0l" class="even stage-finished" style="cursor: pointer;"><td class="cell_ad time">10.11. 20:30</td><td class="cell_aa timer"><span>Koniec</span></td><td class="cell_ab team-home  bold"><span class="padr">Wisła Kraków</span></td><td class="cell_sa score  bold">3&nbsp;-&nbsp;2</td><td class="cell_ac team-away" title="Zobacz szczegóły meczu!"><span class="padl">Zagłębie Lubin</span></td><td class="cell_sb part-top">(2 - 0)</td><td class="cell_ia icons"><span class="icons"></span></td><td class="cell_ib icons"></td></tr><tr id="g_1_pptRkrNK" class=" stage-finished" style="cursor: pointer;"><td class="cell_ad time">10.11. 18:00</td><td class="cell_aa timer"><span>Koniec</span></td><td class="cell_ab team-home  bold"><span class="padr">Lechia Gdańsk</span></td><td class="cell_sa score  bold">1&nbsp;-&nbsp;0</td><td class="cell_ac team-away" title="Zobacz szczegóły meczu!"><span class="padl">Cracovia</span></td><td class="cell_sb part-top">(0 - 0)</td><td class="cell_ia icons"><span class="icons"></span></td><td class="cell_ib icons"></td></tr><tr id="g_1_dxu5r0Ff" class="even stage-finished" style="cursor: pointer;"><td class="cell_ad time">10.11. 15:30</td><td class="cell_aa timer"><span>Koniec</span></td><td class="cell_ab team-home  bold"><span class="padr">Wisła Płock</span></td><td class="cell_sa score  bold">2&nbsp;-&nbsp;0</td><td class="cell_ac team-away" title="Zobacz szczegóły meczu!"><span class="padl">Zagłębie Sosnowiec</span></td><td class="cell_sb part-top">(1 - 0)</td><td class="cell_ia icons"><span class="icons"></span></td><td class="cell_ib icons"></td></tr><tr id="g_1_0AodpMpr" class=" stage-finished" style="cursor: pointer;"><td class="cell_ad time">09.11. 20:30</td><td class="cell_aa timer"><span>Koniec</span></td><td class="cell_ab team-home  bold"><span class="padr">Pogoń Szczecin</span></td><td class="cell_sa score  bold">2&nbsp;-&nbsp;1</td><td class="cell_ac team-away" title="Zobacz szczegóły meczu!"><span class="padl">Legia Warszawa</span></td><td class="cell_sb part-top">(1 - 0)</td><td class="cell_ia icons"><span class="icons"></span></td><td class="cell_ib icons"></td></tr><tr id="g_1_zFbzTKF7" class="even stage-finished" style="cursor: pointer;"><td class="cell_ad time">09.11. 18:00</td><td class="cell_aa timer"><span>Koniec</span></td><td class="cell_ab team-home"><span class="padr">Górnik Zabrze</span></td><td class="cell_sa score  bold">2&nbsp;-&nbsp;2</td><td class="cell_ac team-away" title="Zobacz szczegóły meczu!"><span class="padl">Śląsk Wrocław</span></td><td class="cell_sb part-top">(2 - 1)</td><td class="cell_ia icons"><span class="icons"></span></td><td class="cell_ib icons"></td></tr><tr id="g_1_dOaWT001" class=" stage-finished" style="cursor: pointer;"><td class="cell_ad time">05.11. 18:00</td><td class="cell_aa timer"><span>Koniec</span></td><td class="cell_ab team-home"><span class="padr">Zagłębie Sosnowiec</span></td><td class="cell_sa score  bold" title="Zobacz szczegóły meczu!">1&nbsp;-&nbsp;4</td><td class="cell_ac team-away  bold" title="Zobacz szczegóły meczu!"><span class="padl">Jagiellonia Białystok</span></td><td class="cell_sb part-top" title="Zobacz szczegóły meczu!">(0 - 1)</td><td class="cell_ia icons"><span class="icons"></span></td><td class="cell_ib icons"></td></tr><tr id="g_1_OE3fxPhL" class="even stage-finished" style="cursor: pointer;"><td class="cell_ad time">04.11. 18:00</td><td class="cell_aa timer"><span>Koniec</span></td><td class="cell_ab team-home" title="Zobacz szczegóły meczu!"><span class="padr">Lech Poznań</span></td><td class="cell_sa score  bold" title="Zobacz szczegóły meczu!">0&nbsp;-&nbsp;1</td><td class="cell_ac team-away  bold" title="Zobacz szczegóły meczu!"><span class="padl">Lechia Gdańsk</span></td><td class="cell_sb part-top" title="Zobacz szczegóły meczu!">(0 - 1)</td><td class="cell_ia icons"><span class="icons"></span></td><td class="cell_ib icons"></td></tr><tr id="g_1_EaARUtoe" class=" stage-finished" style="cursor: pointer;"><td class="cell_ad time">04.11. 15:30</td><td class="cell_aa timer"><span>Koniec</span></td><td class="cell_ab team-home" title="Zobacz szczegóły meczu!"><span class="padr">Zagłębie Lubin</span></td><td class="cell_sa score  bold" title="Zobacz szczegóły meczu!">0&nbsp;-&nbsp;1</td><td class="cell_ac team-away  bold" title="Zobacz szczegóły meczu!"><span class="padl">Korona Kielce</span></td><td class="cell_sb part-top" title="Zobacz szczegóły meczu!">(0 - 0)</td><td class="cell_ia icons"><span class="icons"></span></td><td class="cell_ib icons"></td></tr><tr id="g_1_4QKiyq8R" class="even stage-finished" style="cursor: pointer;"><td class="cell_ad time" title="Zobacz szczegóły meczu!">03.11. 20:30</td><td class="cell_aa timer"><span>Koniec</span></td><td class="cell_ab team-home  bold" title="Zobacz szczegóły meczu!"><span class="padr">Legia Warszawa</span></td><td class="cell_sa score  bold">4&nbsp;-&nbsp;0</td><td class="cell_ac team-away"><span class="padl">Górnik Zabrze</span></td><td class="cell_sb part-top">(3 - 0)</td><td class="cell_ia icons"><span class="icons"></span></td><td class="cell_ib icons"></td></tr><tr id="g_1_0d6NVMVl" class=" stage-finished" style="cursor: pointer;"><td class="cell_ad time">03.11. 18:00</td><td class="cell_aa timer"><span>Koniec</span></td><td class="cell_ab team-home" title="Zobacz szczegóły meczu!"><span class="padr">Śląsk Wrocław</span></td><td class="cell_sa score  bold">0&nbsp;-&nbsp;3</td><td class="cell_ac team-away  bold"><span class="padl">Wisła Płock<span class="racard racard1">&nbsp;</span></span></td><td class="cell_sb part-top">(0 - 0)</td><td class="cell_ia icons"><span class="icons"></span></td><td class="cell_ib icons"></td></tr><tr id="g_1_pO4jw5wF" class="even stage-finished" style="cursor: pointer;"><td class="cell_ad time">03.11. 15:30</td><td class="cell_aa timer"><span>Koniec</span></td><td class="cell_ab team-home"><span class="padr">Cracovia</span></td><td class="cell_sa score  bold">0&nbsp;-&nbsp;0</td><td class="cell_ac team-away" title="Zobacz szczegóły meczu!"><span class="padl">Miedź Legnica</span></td><td class="cell_sb part-top" title="Zobacz szczegóły meczu!">(0 - 0)</td><td class="cell_ia icons"><span class="icons"></span></td><td class="cell_ib icons"></td></tr><tr id="g_1_6Z6JW2Gr" class=" stage-finished" style="cursor: pointer;"><td class="cell_ad time" title="Zobacz szczegóły meczu!">02.11. 20:30</td><td class="cell_aa timer"><span>Koniec</span></td><td class="cell_ab team-home  bold"><span class="padr">Piast Gliwice</span></td><td class="cell_sa score  bold">2&nbsp;-&nbsp;0</td><td class="cell_ac team-away" title="Zobacz szczegóły meczu!"><span class="padl">Wisła Kraków</span></td><td class="cell_sb part-top" title="Zobacz szczegóły meczu!">(1 - 0)</td><td class="cell_ia icons"><span class="icons"></span></td><td class="cell_ib icons"></td></tr><tr id="g_1_j15nvoO8" class="even stage-finished" style="cursor: pointer;"><td class="cell_ad time">02.11. 18:00</td><td class="cell_aa timer"><span>Koniec</span></td><td class="cell_ab team-home"><span class="padr">Arka Gdynia</span></td><td class="cell_sa score  bold">2&nbsp;-&nbsp;3</td><td class="cell_ac team-away  bold" title="Zobacz szczegóły meczu!"><span class="padl">Pogoń Szczecin</span></td><td class="cell_sb part-top">(2 - 1)</td><td class="cell_ia icons"><span class="icons"></span></td><td class="cell_ib icons"></td></tr><tr id="g_1_zgNaGsW1" class=" stage-finished" style="cursor: pointer;"><td class="cell_ad time" title="Zobacz szczegóły meczu!">29.10. 18:00</td><td class="cell_aa timer"><span>Koniec</span></td><td class="cell_ab team-home" title="Zobacz szczegóły meczu!"><span class="padr">Wisła Kraków</span></td><td class="cell_sa score  bold" title="Zobacz szczegóły meczu!">2&nbsp;-&nbsp;2</td><td class="cell_ac team-away" title="Zobacz szczegóły meczu!"><span class="padl">Zagłębie Sosnowiec</span></td><td class="cell_sb part-top">(1 - 0)</td><td class="cell_ia icons"><span class="icons"></span></td><td class="cell_ib icons"></td></tr><tr id="g_1_xbuDPo9F" class="even stage-finished" style="cursor: pointer;"><td class="cell_ad time" title="Zobacz szczegóły meczu!">28.10. 18:00</td><td class="cell_aa timer"><span>Koniec</span></td><td class="cell_ab team-home  bold"><span class="padr">Górnik Zabrze</span></td><td class="cell_sa score  bold" title="Zobacz szczegóły meczu!">2&nbsp;-&nbsp;0</td><td class="cell_ac team-away"><span class="padl">Zagłębie Lubin<span class="racard racard1">&nbsp;</span></span></td><td class="cell_sb part-top" title="Zobacz szczegóły meczu!">(1 - 0)</td><td class="cell_ia icons"><span class="icons"></span></td><td class="cell_ib icons"></td></tr><tr id="g_1_rerLNPwS" class=" stage-finished" style="cursor: pointer;"><td class="cell_ad time" title="Zobacz szczegóły meczu!">28.10. 15:30</td><td class="cell_aa timer"><span>Koniec</span></td><td class="cell_ab team-home"><span class="padr">Korona Kielce</span></td><td class="cell_sa score  bold" title="Zobacz szczegóły meczu!">0&nbsp;-&nbsp;1</td><td class="cell_ac team-away  bold" title="Zobacz szczegóły meczu!"><span class="padl">Cracovia</span></td><td class="cell_sb part-top" title="Zobacz szczegóły meczu!">(0 - 1)</td><td class="cell_ia icons"><span class="icons"></span></td><td class="cell_ib icons"></td></tr><tr id="g_1_d2OeHNGe" class="even stage-finished" style="cursor: pointer;"><td class="cell_ad time" title="Zobacz szczegóły meczu!">27.10. 20:30</td><td class="cell_aa timer"><span>Koniec</span></td><td class="cell_ab team-home  bold" title="Zobacz szczegóły meczu!"><span class="padr">Pogoń Szczecin</span></td><td class="cell_sa score  bold" title="Zobacz szczegóły meczu!">3&nbsp;-&nbsp;0</td><td class="cell_ac team-away" title="Zobacz szczegóły meczu!"><span class="padl">Lech Poznań</span></td><td class="cell_sb part-top" title="Zobacz szczegóły meczu!">(2 - 0)</td><td class="cell_ia icons"><span class="icons"></span></td><td class="cell_ib icons"></td></tr></tbody>
"""

soup = BeautifulSoup(html_doc, 'html.parser')



# TWORZENIE BAZY DANYCH

conn = sqlite3.connect('Baza danych/league.db')

c = conn.cursor()

c.execute("""CREATE TABLE IF NOT EXISTS Wyniki (
    Data TEXT, Druzyna1 TEXT, Wynik TEXT, Druzyna2 TEXT
    )""")

for r in soup.find_all('tr', class_='stage-finished'):
    time = r.find('td', class_='cell_ad time').get_text()
    homet = r.find('td', class_='team-home').get_text()
    score = r.find('td', class_='score').get_text().replace('\xa0', ' ')
    awayt = r.find('td', class_='team-away').get_text().replace('\xa0', '')

    c.execute("INSERT INTO Wyniki (Data, Druzyna1, Wynik, Druzyna2) VALUES (?, ?, ?, ?)", (time, homet, score, awayt))



c.execute("SELECT * FROM Wyniki WHERE Druzyna2='Cracovia'")
conn.commit()

for row in c.fetchall():
    print(row)


conn.close()
